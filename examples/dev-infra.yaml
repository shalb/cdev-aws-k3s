name: aws-backend
kind: backend
provider: s3
spec:
  bucket: {{ .project.variables.state_bucket_name }}
  region: {{ .project.variables.region }}
---
name: k3s-arti-test
template: ./k3s-arti-test/
kind: infrastructure
backend: aws-backend
variables:
  bucket: {{ .project.variables.state_bucket_name }}
  region: {{ .project.variables.region }}
  organization: {{ .project.variables.organization }}
  domain: cluster.dev
  instance_type: "t3.medium"
  k3s_version: "1.20.5+k3s1"
  vpc_id: "vpc-5ecf1234"
  public_subnets:
    - "subnet-d775f0bd"
    - "subnet-6696651a"
  env: "dev"
  azs:
    - "{{ .project.variables.region }}a"
    - "{{ .project.variables.region }}b"
  public_key: "ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABAQC872U0xIGtOQRXhOXHIT...." # Change this.
  public_key_name: arti
  master_node_count: 1
  worker_node_groups:
    - name: "node_pool"
      min_size: 2
      max_size: 3
      instance_type: "t3.medium"
  argocdServerAdminPassword: "$2a$10$1buVsK9yv0Al1oJlLmABeeRxYsArdlT2QPdNRqaZwiuYztj9JUDmu" # Bcrypted "password"
